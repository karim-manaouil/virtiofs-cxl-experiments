#!/bin/sh
set -o xtrace

echo 0 > /proc/sys/kernel/numa_balancing

for cpu in /sys/devices/system/cpu/cpu*/cpufreq/scaling_governor; do
	echo performance > $cpu
done

echo 64 > /sys/kernel/mm/hugepages/hugepages-1048576kB/nr_hugepages

mount -t hugetlbfs none /dev/hugepages/ -opagesize=1G

fallocate -l 32G /dev/hugepages/memory-file-vm0
fallocate -l 32G /dev/hugepages/memory-file-vm1

/home/karim/vmctl.sh bridge vmbr0
/home/karim/vmctl.sh taps vmbr0 tap0 tap1
/home/karim/vmctl.sh route vmbr0 enp2s0f0np0

